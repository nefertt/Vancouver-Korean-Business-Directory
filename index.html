<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë°´ì¿ ë²„ í•œì¸ ì—…ì²´ ëª©ë¡ - Vancouver Korean Business Directory</title>
    <meta
      name="description"
      content="ë°´ì¿ ë²„ í•œì¸ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ìœ„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë””ë ‰í† ë¦¬. ìŒì‹ì , ë§ˆíŠ¸, ë³‘ì›, ë¶€ë™ì‚° ë“± 150+ í•œì¸ ì—…ì²´ ì •ë³´ë¥¼ í•œ ê³³ì—ì„œ ì°¾ì•„ë³´ì„¸ìš”."
    />
    <meta name="keywords" content="ë°´ì¿ ë²„, í•œì¸, ë¹„ì¦ˆë‹ˆìŠ¤, ë””ë ‰í† ë¦¬, í•œì¸ì—…ì²´, í•œì¸ë§ˆíŠ¸, í•œì¸ìŒì‹ì " />
    <meta name="author" content="Vancouver Korean Business Directory" />
    <link rel="canonical" href="https://nefertt.github.io/Vancouver-Korean-Business-Directory/" />
    <!-- Open Graph Meta Tags -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://nefertt.github.io/Vancouver-Korean-Business-Directory/" />
    <meta property="og:title" content="ë°´ì¿ ë²„ í•œì¸ ì—…ì²´ ëª©ë¡ - Vancouver Korean Business Directory" />
    <meta
      property="og:description"
      content="ë°´ì¿ ë²„ í•œì¸ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ìœ„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë””ë ‰í† ë¦¬. ìŒì‹ì , ë§ˆíŠ¸, ë³‘ì›, ë¶€ë™ì‚° ë“± 150+ í•œì¸ ì—…ì²´ ì •ë³´"
    />
    <meta
      property="og:image"
      content="https://images.unsplash.com/photo-1552664730-d307ca884978?w=1200&h=630&fit=crop"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://nefertt.github.io/Vancouver-Korean-Business-Directory/" />
    <meta name="twitter:title" content="ë°´ì¿ ë²„ í•œì¸ ì—…ì²´ ëª©ë¡ - Vancouver Korean Business Directory" />
    <meta
      name="twitter:description"
      content="ë°´ì¿ ë²„ í•œì¸ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ìœ„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë””ë ‰í† ë¦¬. ìŒì‹ì , ë§ˆíŠ¸, ë³‘ì›, ë¶€ë™ì‚° ë“± 150+ í•œì¸ ì—…ì²´ ì •ë³´"
    />
    <meta
      name="twitter:image"
      content="https://images.unsplash.com/photo-1552664730-d307ca884978?w=1200&h=630&fit=crop"
    />
    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸª</text></svg>"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles/styles.css" />
    <!-- FIXME: Leaflet CSS ì•„ë‹Œë° ì™œ ìê¾¸ CSSë¡œ ë§Œë“œëŠ”ì§€ ëª¨ë¥´ê² ìŒ; -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@2.0.0-alpha.1/dist/leaflet.css" crossorigin="" />
    <!-- JSON-LD Schema.org êµ¬ì¡°í™”ëœ ë°ì´í„° -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "name": "Vancouver Korean Business Directory",
        "description": "ë°´ì¿ ë²„ í•œì¸ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ìœ„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë””ë ‰í† ë¦¬",
        "url": "https://nefertt.github.io/Vancouver-Korean-Business-Directory/",
        "logo": "https://images.unsplash.com/photo-1552664730-d307ca884978?w=200&h=200&fit=crop",
        "image": "https://images.unsplash.com/photo-1552664730-d307ca884978?w=1200&h=630&fit=crop",
        "telephone": "",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Vancouver",
          "addressRegion": "BC",
          "addressCountry": "CA"
        },
        "areaServed": {
          "@type": "City",
          "name": "Vancouver"
        },
        "priceRange": "varies"
      }
    </script>
    <!-- JSON-LD Organization -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Vancouver Korean Business Directory",
        "alternateName": "ë°´ì¿ ë²„ í•œì¸ ì—…ì²´ ëª©ë¡",
        "url": "https://nefertt.github.io/Vancouver-Korean-Business-Directory/",
        "logo": "https://images.unsplash.com/photo-1552664730-d307ca884978?w=200&h=200&fit=crop",
        "description": "ë°´ì¿ ë²„ í•œì¸ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ìœ„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë””ë ‰í† ë¦¬",
        "sameAs": ["https://www.google.com"]
      }
    </script>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-33EN2Y3FC9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'G-33EN2Y3FC9');
    </script>
    <script src="scripts/loadNavbar.js"></script>
  </head>
  <body>
    <div id="navbar-placeholder"></div>

    <section class="hero">
      <div class="container">
        <div class="hero-content">
          <h2 class="hero-title" id="hero-title">ë°´ì¿ ë²„ ìƒí™œ, í•œ ë²ˆì— ì°¾ëŠ” í•œì¸ ì—…ì²´ ëª©ë¡</h2>
          <p class="hero-subtitle" id="hero-subtitle">ìŒì‹ì , ë§ˆíŠ¸, ë³‘ì›, ë¶€ë™ì‚°, ëª¨ë“  ìƒí™œ ì •ë³´ë¥¼ í•œ ê³³ì—ì„œ.</p>
          <div class="search-container">
            <input type="text" class="search-input" id="search-input" placeholder="ì—…ì²´ëª… Â· ì—…ì¢… Â· ì§€ì—­ìœ¼ë¡œ ê²€ìƒ‰" />
            <button class="search-btn" id="search-btn">ê²€ìƒ‰</button>
          </div>
          <button class="cta-btn" id="cta-btn">ë‚´ ì£¼ë³€ í•œì¸ ì—…ì²´ ë³´ê¸°</button>
        </div>
      </div>
    </section>

    <section class="categories">
      <div class="container">
        <h3 class="section-title" id="categories-title">ì¹´í…Œê³ ë¦¬ë³„ ì°¾ê¸°</h3>
        <div class="category-grid"></div>
      </div>
    </section>

    <section class="featured">
      <div class="container">
        <h3 class="section-title" id="featured-title">ì¶”ì²œ ì—…ì²´</h3>
        <div class="featured-grid"></div>
      </div>
    </section>

    <section class="map-instagram-section">
      <div class="container">
        <div class="map-instagram-grid">
          <div class="map-preview">
            <h3 class="section-title" id="map-title">ì§€ë„ì—ì„œ ë³´ê¸°</h3>
            <div class="map-container">
              <div id="homeMap" class="leaflet-map"></div>
              <div class="map-overlay">
                <div class="map-info">
                  <h4 id="map-description-title">ë°´ì¿ ë²„ í•œì¸ ì—…ì²´ ìœ„ì¹˜</h4>
                  <p id="map-description">ì§€ë„ì—ì„œ í•œì¸ ì—…ì²´ë“¤ì„ ì°¾ì•„ë³´ì„¸ìš”</p>
                  <button class="map-btn" id="map-button" onclick="window.location.href='./map.html'">
                    ì „ì²´ ì§€ë„ ë³´ê¸°
                  </button>
                </div>
              </div>
            </div>

            <div class="ad-banner">
              <div class="ad-content">
                <div class="ad-header">
                  <span class="ad-label" id="ad-label">ê´‘ê³ </span>
                </div>
                <div class="ad-main">
                  <div class="ad-image">ğŸ¢</div>
                  <div class="ad-text">
                    <h4 id="ad-title">ë°´ì¿ ë²„ í•œì¸ ì—…ì²´ í™ë³´</h4>
                    <p id="ad-description">ì—¬ê¸°ì— ì—¬ëŸ¬ë¶„ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ë¥¼ í™ë³´í•´ë³´ì„¸ìš”!</p>
                    <div class="ad-cta">
                      <button class="ad-btn" id="ad-button">ê´‘ê³  ë¬¸ì˜í•˜ê¸°</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="stats-banner">
              <div class="stats-content">
                <div class="stats-header">
                  <span class="stats-label" id="stats-label">í†µê³„</span>
                </div>
                <div class="stats-grid">
                  <div class="stat-item">
                    <div class="stat-icon">ğŸª</div>
                    <div class="stat-info">
                      <span class="stat-number">150+</span>
                      <span class="stat-label stat-businesses" id="stat-businesses">ë“±ë¡ëœ ì—…ì²´</span>
                    </div>
                  </div>
                  <div class="stat-item">
                    <div class="stat-icon">ğŸ‘¥</div>
                    <div class="stat-info">
                      <span class="stat-number">5,000+</span>
                      <span class="stat-label stat-visitors" id="stat-visitors">ì›” ë°©ë¬¸ì</span>
                    </div>
                  </div>
                  <div class="stat-item">
                    <div class="stat-icon">â­</div>
                    <div class="stat-info">
                      <span class="stat-number">4.8</span>
                      <span class="stat-label stat-rating" id="stat-rating">í‰ê·  í‰ì </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="instagram-feed">
            <div class="instagram-container">
              <div class="instagram-embed">
                <div class="instagram-post-single">
                  <div class="post-header">
                    <div class="post-profile">
                      <div class="profile-pic">ğŸ“·</div>
                      <div class="profile-info">
                        <span class="username">@ë°´ì¿ ë²„í•œì¸ë¹„ì¦ˆë‹ˆìŠ¤</span>
                        <span class="location">Vancouver, BC</span>
                      </div>
                    </div>
                    <div class="post-menu">â‹¯</div>
                  </div>
                  <div class="post-image-container">
                    <div class="post-image-main">ğŸ–¼ï¸</div>
                  </div>
                  <div class="post-actions">
                    <div class="action-buttons">
                      <span class="action-btn">â¤ï¸</span>
                      <span class="action-btn">ğŸ’¬</span>
                      <span class="action-btn">ğŸ“¤</span>
                    </div>
                    <span class="action-btn bookmark">ğŸ”–</span>
                  </div>
                  <div class="post-content">
                    <p><strong>@ë°´ì¿ ë²„í•œì¸ë¹„ì¦ˆë‹ˆìŠ¤</strong> ë°´ì¿ ë²„ í•œì¸ ì»¤ë®¤ë‹ˆí‹°ì˜ ìµœì‹  ì†Œì‹ì„ ë§Œë‚˜ë³´ì„¸ìš”! ğŸ™ï¸âœ¨</p>
                    <p class="post-time">2ì‹œê°„ ì „</p>
                  </div>
                </div>
                <button class="instagram-btn" id="instagram-button">ì¸ìŠ¤íƒ€ê·¸ë¨ì—ì„œ ë” ë³´ê¸°</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <button class="scroll-to-top" id="scrollToTop" title="ë§¨ ìœ„ë¡œ ê°€ê¸°">â†‘</button>

    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <h3>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</h3>
      </div>
    </div>

    <div id="footer-placeholder"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@2.0.0-alpha.1/dist/leaflet-global.js" crossorigin=""></script>

    <script src="scripts/loadTheme.js"></script>
    <script src="scripts/loadFooter.js"></script>
    <script src="scripts/googleSheets.js"></script>
    <script src="scripts/initScrollToTop.js"></script>
    <script src="scripts/i18n.js"></script>
    <script src="scripts/pageInit.js"></script>
    <script>
      // index ì „ìš©: ê²€ìƒ‰ placeholder ë™ê¸°í™” ë° ì¹´í…Œê³ ë¦¬ ì¹´ë“œ í…ìŠ¤íŠ¸ ì²˜ë¦¬
      document.addEventListener('DOMContentLoaded', function () {
        function applyIndexTexts(lang) {
          if (window.I18N && typeof window.I18N.applyPage === 'function') {
            window.I18N.applyPage(lang, 'index');
          }
          const searchInput = document.getElementById('search-input');
          if (searchInput && window.I18N && typeof window.I18N.get === 'function') {
            searchInput.placeholder = window.I18N.get(lang, 'index', 'search-placeholder') || searchInput.placeholder;
          }
          // ì¹´í…Œê³ ë¦¬ ì¹´ë“œì˜ í•œ/ì˜ í‘œì‹œ ê·œì¹™ ìœ ì§€
          if (window.categoryData) {
            renderCategories(window.categoryData, lang);
          }
        }

        const savedLang = localStorage.getItem('language') || 'ko';
        setTimeout(() => {
          applyIndexTexts(savedLang);
          if (typeof initHomeMap === 'function') initHomeMap();
        }, 150);

        window.addEventListener('languagechange', function (e) {
          const lang = (e && e.detail && e.detail.language) || localStorage.getItem('language') || 'ko';
          setTimeout(() => applyIndexTexts(lang), 50);
        });

        function updateCategoriesSection(lang) {
          const categoryCards = document.querySelectorAll('.category-card');

          categoryCards.forEach((card) => {
            const titleElement = card.querySelector('h4');
            const subtitleElement = card.querySelector('p');

            if (titleElement) {
              // Get the category data
              const categoryData = window.categoryData || [];

              if (lang === 'en') {
                // English: Show English category name as title, hide subtitle
                const currentTitle = titleElement.textContent;
                const category = categoryData.find((cat) => cat.categoryDisplay === currentTitle);
                if (category) {
                  titleElement.textContent = category.category;
                }
                // Hide subtitle for English
                if (subtitleElement) {
                  subtitleElement.style.display = 'none';
                }
              } else {
                // Korean: Show Korean category name as title, English category name as subtitle
                const currentTitle = titleElement.textContent;
                const category = categoryData.find((cat) => cat.category === currentTitle);
                if (category) {
                  titleElement.textContent = category.categoryDisplay;
                  if (subtitleElement) {
                    subtitleElement.textContent = category.category;
                    subtitleElement.style.display = 'block';
                  }
                }
              }
            }
          });
        }

        // updateFooterëŠ” loadFooter.jsì—ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤

        // ì´ˆê¸° i18n ì ìš©ì€ ìœ„ì—ì„œ ì²˜ë¦¬

        // Load data from Google Sheets via shared module
        getBusinesses()
          .then((businesses) => {
            const lang = localStorage.getItem('language') || 'ko';
            loadFeaturedBusinesses(businesses);
            loadCategories(businesses, lang);
          })
          .catch(() => {
            renderStaticFeaturedBusinesses();
            renderStaticCategories('ko');
          });

        /**
         * Featured businesses ë Œë”ë§ (ì´ë¯¸ ë¡œë“œëœ ë°ì´í„° ì‚¬ìš©)
         */
        function loadFeaturedBusinesses(businesses) {
          try {
            if (!businesses || businesses.length === 0) {
              throw new Error('No businesses data available');
            }

            // Filter featured businesses - if no featured column, show first 6 businesses
            let featuredBusinesses;
            const hasFeaturedColumn = businesses.length > 0 && businesses[0].hasOwnProperty('featured');

            if (hasFeaturedColumn) {
              // If featured column exists, filter by it
              const featuredFiltered = businesses.filter(
                (business) => business.featured === 'true' || business.featured === 'TRUE' || business.featured === '1',
              );
              featuredBusinesses = featuredFiltered.slice(0, PERFORMANCE_LIMITS.FEATURED_LIMIT);
            } else {
              // If no featured column, show first N businesses
              featuredBusinesses = businesses.slice(0, PERFORMANCE_LIMITS.FEATURED_LIMIT);
            }

            renderFeaturedBusinesses(featuredBusinesses);
          } catch (error) {
            console.error('âŒ Error loading featured businesses:', error);

            // Show error message
            const featuredGrid = document.querySelector('.featured-grid');
            if (featuredGrid) {
              featuredGrid.innerHTML = `
                <div style="text-align: center; padding: 2rem; color: #666;">
                  <p>ì¶”ì²œ ì—…ì²´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                  <p style="font-size: 0.9rem; margin-top: 0.5rem;">ì˜¤ë¥˜: ${error.message}</p>
                  <p style="font-size: 0.8rem; margin-top: 0.5rem;">ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>
                  <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #1e4da1; color: white; border: none; border-radius: 4px; cursor: pointer;">ìƒˆë¡œê³ ì¹¨</button>
                </div>
              `;
            }

            // Fallback to static data
            renderStaticFeaturedBusinesses();
          }
        }

        function parseCSV(csvText) {
          try {
            const lines = csvText.split('\n');

            if (lines.length < 2) {
              throw new Error('CSV data is too short');
            }

            const headers = parseCSVLine(lines[0]);

            const businesses = [];

            for (let i = 1; i < lines.length; i++) {
              if (lines[i].trim()) {
                const values = parseCSVLine(lines[i]);

                if (values.length !== headers.length) {
                  // Skip warning in production
                }

                const business = {};
                headers.forEach((header, index) => {
                  business[header] = values[index] || '';
                });
                businesses.push(business);
              }
            }

            return businesses;
          } catch (error) {
            console.error('âŒ CSV parsing error:', error);
            throw error;
          }
        }

        function parseCSVLine(line) {
          try {
            const result = [];
            let current = '';
            let inQuotes = false;

            for (let i = 0; i < line.length; i++) {
              const char = line[i];

              if (char === '"') {
                inQuotes = !inQuotes;
              } else if (char === ',' && !inQuotes) {
                result.push(current.trim().replace(/^"|"$/g, ''));
                current = '';
              } else {
                current += char;
              }
            }

            result.push(current.trim().replace(/^"|"$/g, ''));
            return result;
          } catch (error) {
            console.error('âŒ CSV line parsing error:', error);
            throw error;
          }
        }

        function renderFeaturedBusinesses(businesses) {
          const featuredGrid = document.querySelector('.featured-grid');
          if (!featuredGrid) {
            return;
          }

          featuredGrid.innerHTML = '';

          if (!businesses || businesses.length === 0) {
            featuredGrid.innerHTML = '<p>ì¶”ì²œ ì—…ì²´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            return;
          }

          businesses.forEach((business) => {
            try {
              const businessCard = createBusinessCard(business);
              featuredGrid.appendChild(businessCard);
            } catch (error) {}
          });
        }

        function createBusinessCard(business) {
          const card = document.createElement('div');
          card.className = 'business-card';

          const categoryIcon = getCategoryIcon(business.category);
          const categoryDisplay = business.categoryDisplay || business.category || 'ì—…ì²´';

          card.innerHTML = `
            <div class="business-image">
              <img
                src="${
                  business.image || 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=300&h=200&fit=crop'
                }"
                alt="${business.name || business.nameEn || 'Business'}"
                onerror="this.src='https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=300&h=200&fit=crop'"
              />
            </div>
            <div class="business-info">
              <h4>${business.name || business.nameEn || 'ì—…ì²´ëª…'}</h4>
              <p class="business-category">${categoryIcon} ${categoryDisplay}</p>
              <p class="business-location">${business.address || 'ì£¼ì†Œ ì •ë³´ ì—†ìŒ'}</p>
            </div>
          `;

          return card;
        }

        /**
         * Categories ë Œë”ë§ (ì´ë¯¸ ë¡œë“œëœ ë°ì´í„° ì‚¬ìš©)
         */
        function loadCategories(businesses, lang = 'ko') {
          try {
            if (!businesses || businesses.length === 0) {
              throw new Error('No businesses data available');
            }

            // Extract unique categories from businesses (fallback when display name missing)
            const categoryMap = new Map();
            businesses.forEach((business) => {
              if (business.category) {
                const rawCategory = String(business.category).trim();
                if (!rawCategory) return;
                const categoryKey = rawCategory.toLowerCase();
                if (!categoryMap.has(categoryKey)) {
                  categoryMap.set(categoryKey, {
                    category: rawCategory,
                    categoryDisplay: business.categoryDisplay || rawCategory,
                    icon: getCategoryIcon(rawCategory),
                  });
                }
              }
            });

            // Convert to array and, if too few, fallback to static categories
            let categories = Array.from(categoryMap.values());
            if (categories.length < 8) {
              // Merge with static to ensure at least 8 shown
              const staticCategories = [
                {
                  category: 'Restaurants',
                  categoryDisplay: 'ìŒì‹ì ',
                  icon: 'ğŸœ',
                },
                {
                  category: 'Grocery Stores',
                  categoryDisplay: 'ë§ˆíŠ¸',
                  icon: 'ğŸ›’',
                },
                { category: 'Medical', categoryDisplay: 'ë³‘ì›', icon: 'ğŸ¥' },
                {
                  category: 'Legal/Accounting',
                  categoryDisplay: 'ë²•ë¥ /íšŒê³„',
                  icon: 'âš–ï¸',
                },
                {
                  category: 'Real Estate',
                  categoryDisplay: 'ë¶€ë™ì‚°',
                  icon: 'ğŸ ',
                },
                {
                  category: 'Beauty',
                  categoryDisplay: 'ë¯¸ìš©/ë·°í‹°',
                  icon: 'ğŸ’‡',
                },
                {
                  category: 'Automotive',
                  categoryDisplay: 'ìë™ì°¨',
                  icon: 'ğŸš—',
                },
                { category: 'Education', categoryDisplay: 'êµìœ¡', icon: 'ğŸ“' },
              ];
              const existingKeys = new Set(categories.map((c) => c.categoryDisplay));
              staticCategories.forEach((c) => {
                if (!existingKeys.has(c.categoryDisplay)) categories.push(c);
              });
            }

            // Respect performance limit if set
            categories = categories.slice(
              0,
              (window.PERFORMANCE_LIMITS && window.PERFORMANCE_LIMITS.CATEGORY_LIMIT) || 20,
            );

            // Store categories globally for language switching
            window.categoryData = categories;

            renderCategories(categories, lang);
          } catch (error) {
            // Fallback to static categories
            renderStaticCategories(lang);
          }
        }

        function getCategoryIcon(category) {
          const iconMap = {
            restaurant: 'ğŸœ',
            grocery: 'ğŸ›’',
            medical: 'ğŸ¥',
            legal: 'âš–ï¸',
            realestate: 'ğŸ ',
            beauty: 'ğŸ’‡',
            automotive: 'ğŸš—',
            education: 'ğŸ“',
            ìŒì‹ì : 'ğŸœ',
            ë§ˆíŠ¸: 'ğŸ›’',
            ë³‘ì›: 'ğŸ¥',
            ë²•ë¥ : 'âš–ï¸',
            ë¶€ë™ì‚°: 'ğŸ ',
            ë¯¸ìš©: 'ğŸ’‡',
            ìë™ì°¨: 'ğŸš—',
            êµìœ¡: 'ğŸ“',
          };

          return iconMap[category.toLowerCase()] || 'ğŸ“‹';
        }

        function renderCategories(categories, lang = 'ko') {
          const categoryGrid = document.querySelector('.category-grid');
          if (!categoryGrid) {
            return;
          }

          categoryGrid.innerHTML = '';

          categories.forEach((category) => {
            const categoryCard = createCategoryCard(category, lang);
            categoryGrid.appendChild(categoryCard);
          });
        }

        function createCategoryCard(category, lang = 'ko') {
          const card = document.createElement('div');
          card.className = 'category-card';

          // Get current language
          const isKorean = lang === 'ko';

          card.innerHTML = `
            <div class="category-icon">${category.icon}</div>
            <h4>${isKorean ? category.categoryDisplay : category.category}</h4>
            ${isKorean ? `<p>${category.category}</p>` : ''}
          `;

          return card;
        }

        function renderStaticCategories(lang = 'ko') {
          // Fallback static categories
          const staticCategories = [
            { category: 'Restaurants', categoryDisplay: 'ìŒì‹ì ', icon: 'ğŸœ' },
            { category: 'Grocery Stores', categoryDisplay: 'ë§ˆíŠ¸', icon: 'ğŸ›’' },
            { category: 'Medical', categoryDisplay: 'ë³‘ì›', icon: 'ğŸ¥' },
            {
              category: 'Legal/Accounting',
              categoryDisplay: 'ë²•ë¥ /íšŒê³„',
              icon: 'âš–ï¸',
            },
            { category: 'Real Estate', categoryDisplay: 'ë¶€ë™ì‚°', icon: 'ğŸ ' },
            { category: 'Beauty', categoryDisplay: 'ë¯¸ìš©/ë·°í‹°', icon: 'ğŸ’‡' },
            { category: 'Automotive', categoryDisplay: 'ìë™ì°¨', icon: 'ğŸš—' },
            { category: 'Education', categoryDisplay: 'êµìœ¡', icon: 'ğŸ“' },
          ];

          // Store categories globally for language switching
          window.categoryData = staticCategories;

          renderCategories(staticCategories, lang);
        }

        function renderStaticFeaturedBusinesses() {
          // Fallback static featured businesses
          const staticBusinesses = [
            {
              category: 'restaurant',
              categoryDisplay: 'ìŒì‹ì ',
              name: 'í•œì†¥ë„ì‹œë½',
              nameEn: 'Honsot Dosirak',
              description: 'ì •í†µ í•œêµ­ ìš”ë¦¬ë¥¼ ë§›ë³¼ ìˆ˜ ìˆëŠ” ê³³',
              rating: '4.5',
              address: '1234 Kingsway, Burnaby, BC',
              image: 'https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=300&h=200&fit=crop',
            },
            {
              category: 'grocery',
              categoryDisplay: 'ë§ˆíŠ¸',
              name: 'í•œë§ˆìŒë§ˆíŠ¸',
              nameEn: 'Hanmaeum Market',
              description: 'í•œêµ­ ì‹ì¬ë£Œë¥¼ êµ¬í•  ìˆ˜ ìˆëŠ” ë§ˆíŠ¸',
              rating: '4.2',
              address: '5678 Granville St, Vancouver, BC',
              image: 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=300&h=200&fit=crop',
            },
          ];

          renderFeaturedBusinesses(staticBusinesses);
        }

        // Initialize Leaflet map on homepage
        function initHomeMap() {
          const mapElement = document.getElementById('homeMap');
          if (!mapElement) return;

          // Vancouver center coordinates
          const vancouverCenter = [49.2827, -123.1207];

          // Initialize Leaflet map
          const map = new L.Map('homeMap').setView(vancouverCenter, 12);

          // Add OpenStreetMap tiles
          const tiles = new L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
          }).addTo(map);

          // Add a sample marker for demonstration

          L.marker([49.2827, -123.1207]).addTo(map).bindPopup('ë°´ì¿ ë²„ í•œì¸ ì—…ì²´ ìœ„ì¹˜').openPopup();

          // Resize map when container is visible
          setTimeout(() => {
            map.invalidateSize();
          }, 100);
        }

        // Scroll to top ê¸°ëŠ¥ì€ scripts/common.jsì—ì„œ ì²˜ë¦¬í•©ë‹ˆë‹¤
      });
    </script>
  </body>
</html>
