<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>업체 등록 - 밴쿠버 한인 업체 목록</title>
    <link rel="stylesheet" href="../styles/styles.css" />
    <link rel="stylesheet" href="../styles/submit.css" />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <div class="header-top">
          <div class="logo">
            <a href="./index.html">
              <h1>밴쿠버 한인 업체 목록</h1>
            </a>
          </div>
          <nav class="nav">
            <a href="./index.html" class="nav-link">홈</a>
            <a href="./directory.html" class="nav-link">업체 목록</a>
            <a href="./map.html" class="nav-link">지도</a>
            <a href="./board.html" class="nav-link">게시판</a>
            <a href="./submit.html" class="nav-link active">업체 등록</a>
            <a href="./guide.html" class="nav-link">가이드</a>
            <a href="./about.html" class="nav-link">소개</a>
          </nav>
          <div class="header-controls">
            <div class="language-toggle">
              <button class="lang-btn active" data-lang="ko">KO</button>
              <button class="lang-btn" data-lang="en">EN</button>
            </div>
            <button class="theme-toggle" id="themeToggle">
              <span id="themeIcon">🌙</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <div class="container">
      <!-- Main Content -->
      <main class="main-content">
        <div class="submit-container">
          <div class="submit-header">
            <h2>업체 등록</h2>
            <p>밴쿠버 한인 커뮤니티에 업체를 등록해보세요!</p>
          </div>

          <div class="submit-content">
            <div class="submit-info">
              <h3>📋 등록 안내</h3>
              <ul>
                <li>
                  ✅ <strong>무료 등록</strong> - 비용 없이 업체를 등록할 수
                  있습니다
                </li>
                <li>
                  ✅ <strong>빠른 승인</strong> - 24시간 내에 검토 후 승인됩니다
                </li>
                <li>
                  ✅ <strong>실시간 업데이트</strong> - 승인 즉시 웹사이트에
                  반영됩니다
                </li>
                <li>
                  ✅ <strong>지도 연동</strong> - 위치 정보가 지도에 자동으로
                  표시됩니다
                </li>
              </ul>
            </div>

            <div class="submit-form-container">
              <h3>📝 업체 정보 입력</h3>
              <div class="form-embed">
                <!-- Google Forms 임베드 영역 -->
                <div class="form-placeholder" style="display: none">
                  <div class="form-error">
                    <h4>⚠️ 구글폼 연결 오류</h4>
                    <p>
                      현재 구글폼에 연결할 수 없습니다. 새로운 구글폼을
                      생성해주세요.
                    </p>
                    <div class="form-instructions">
                      <h5>구글폼 생성 방법:</h5>
                      <ol>
                        <li>
                          <a href="https://forms.google.com" target="_blank"
                            >Google Forms</a
                          >에 접속
                        </li>
                        <li>새 폼 생성</li>
                        <li>
                          필요한 필드 추가 (업체명, 주소, 전화번호, 카테고리 등)
                        </li>
                        <li>폼 설정에서 "응답 수집" → "링크 전송" 선택</li>
                        <li>생성된 링크를 아래 iframe src에 업데이트</li>
                      </ol>
                    </div>
                    <div class="form-link">
                      <p><strong>새 구글폼 링크:</strong></p>
                      <input
                        type="text"
                        id="newFormUrl"
                        placeholder="새 구글폼 URL을 여기에 입력하세요"
                        style="width: 100%; padding: 10px; margin: 10px 0"
                      />
                      <button
                        onclick="updateFormUrl()"
                        style="
                          padding: 10px 20px;
                          background: #1e4da1;
                          color: white;
                          border: none;
                          border-radius: 5px;
                          cursor: pointer;
                        "
                      >
                        폼 업데이트
                      </button>
                    </div>
                  </div>
                </div>
                <iframe
                  src="https://docs.google.com/forms/d/e/1FAIpQLSfgfJUQld8kiJCv-w-4tqYcERbpSlUTA3JDC87carXqnDqFPA/viewform?embedded=true"
                  frameborder="0"
                  marginheight="0"
                  marginwidth="0"
                  id="googleForm"
                  class="google-form-iframe"
                >
                  로딩 중...
                </iframe>
              </div>
            </div>

            <div class="submit-tips">
              <h3>💡 등록 팁</h3>
              <div class="tips-grid">
                <div class="tip-card">
                  <h4>📍 정확한 주소</h4>
                  <p>
                    Google Maps에서 정확한 주소를 확인하여 입력해주세요. 지도에
                    정확히 표시됩니다.
                  </p>
                </div>
                <div class="tip-card">
                  <h4>🕒 영업시간</h4>
                  <p>
                    정확한 영업시간을 입력해주세요. 고객들이 방문 전에 확인할 수
                    있습니다.
                  </p>
                </div>
                <div class="tip-card">
                  <h4>📸 사진</h4>
                  <p>
                    업체 외관이나 대표 메뉴 사진을 업로드하면 더 많은 고객이
                    관심을 가질 수 있습니다.
                  </p>
                </div>
                <div class="tip-card">
                  <h4>📝 상세 설명</h4>
                  <p>업체의 특징이나 특별한 서비스를 자세히 설명해주세요.</p>
                </div>
              </div>
            </div>

            <div class="submit-contact">
              <h3>📞 문의사항</h3>
              <p>
                등록 과정에서 문제가 있거나 도움이 필요하시면 언제든 연락주세요!
              </p>
              <div class="contact-info">
                <p>📧 이메일: contact@vancouver-korean.com</p>
                <p>📱 카카오톡: @vancouver-korean</p>
              </div>
            </div>
          </div>
        </div>
      </main>

      <!-- Scroll to Top Button -->
      <button class="scroll-to-top" id="scrollToTop" title="맨 위로 가기">
        ↑
      </button>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <p>&copy; 2025 밴쿠버 한인 업체 목록. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <script src="../scripts/submit.js"></script>

    <script>
      // Dark mode functionality
      document.addEventListener("DOMContentLoaded", function () {
        const themeToggle = document.getElementById("themeToggle");
        const body = document.body;
        const themeIcon = themeToggle.querySelector("span");

        // Load saved theme
        const savedTheme = localStorage.getItem("theme") || "light";
        body.setAttribute("data-theme", savedTheme);
        updateThemeIcon(savedTheme);

        // Ensure iframe is visible
        const iframe = document.getElementById("googleForm");
        if (iframe) {
          console.log("iframe found, setting styles...");
          iframe.style.display = "block";
          iframe.style.visibility = "visible";
          iframe.style.opacity = "1";
          console.log("iframe styles set:", {
            display: iframe.style.display,
            visibility: iframe.style.visibility,
            opacity: iframe.style.opacity,
          });
        } else {
          console.log("iframe not found!");
        }

        // Periodic check to ensure iframe stays visible
        setInterval(function () {
          const iframe = document.getElementById("googleForm");
          if (
            iframe &&
            (iframe.style.display === "none" ||
              iframe.style.visibility === "hidden" ||
              iframe.style.opacity === "0")
          ) {
            console.log("iframe was hidden, restoring...");
            iframe.style.display = "block";
            iframe.style.visibility = "visible";
            iframe.style.opacity = "1";
          }
        }, 1000);

        // Theme toggle event listener
        themeToggle.addEventListener("click", function () {
          const currentTheme = body.getAttribute("data-theme");
          const newTheme = currentTheme === "dark" ? "light" : "dark";

          body.setAttribute("data-theme", newTheme);
          localStorage.setItem("theme", newTheme);
          updateThemeIcon(newTheme);
        });

        function updateThemeIcon(theme) {
          themeIcon.textContent = theme === "dark" ? "☀️" : "🌙";
        }

        // Scroll to top functionality
        const scrollToTopBtn = document.getElementById("scrollToTop");

        window.addEventListener("scroll", function () {
          if (window.pageYOffset > 300) {
            scrollToTopBtn.classList.add("show");
          } else {
            scrollToTopBtn.classList.remove("show");
          }
        });

        scrollToTopBtn.addEventListener("click", function () {
          window.scrollTo({
            top: 0,
            behavior: "smooth",
          });
        });
      });

      // Form URL update function
      function updateFormUrl() {
        const newUrl = document.getElementById("newFormUrl").value;
        const iframe = document.getElementById("googleForm");
        const placeholder = document.querySelector(".form-placeholder");

        if (newUrl && newUrl.includes("docs.google.com/forms")) {
          // Add embedded parameter if not present
          let embedUrl = newUrl;
          if (!embedUrl.includes("embedded=true")) {
            embedUrl += (embedUrl.includes("?") ? "&" : "?") + "embedded=true";
          }

          iframe.src = embedUrl;
          iframe.style.display = "block";
          placeholder.style.display = "none";

          alert("구글폼이 성공적으로 업데이트되었습니다!");
        } else {
          alert("올바른 구글폼 URL을 입력해주세요.");
        }
      }
    </script>
  </body>
</html>
